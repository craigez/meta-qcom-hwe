From f693a385e250457b27c68ce15a4d2a7574739094 Mon Sep 17 00:00:00 2001
From: Chirag Jain <quic_chirjain@quicinc.com>
Date: Wed, 20 Dec 2023 16:20:03 +0530
Subject: [PATCH] bt: changes in Makefile

changes to remove dependency on WORKSPACE variable

Change-Id: I32eef4f88047022218c8b08a109c9db5eb059ccd
---
 audio_a2dp_hw/Makefile.am |  2 --
 bta/Makefile.am           | 14 ++++++-------
 btcore/Makefile.am        |  3 +--
 btif/Makefile.am          | 11 ++---------
 device/Makefile.am        |  5 ++---
 hci/Makefile.am           | 16 +++++++--------
 main/Makefile.am          | 12 +++++-------
 osi/Makefile.am           |  4 ++--
 stack/Makefile.am         | 41 ++++++++++++++++++---------------------
 utils/Makefile.am         |  4 ++--
 10 files changed, 48 insertions(+), 64 deletions(-)

diff --git a/audio_a2dp_hw/Makefile.am b/audio_a2dp_hw/Makefile.am
index 1cf48a0f3..1237e84dc 100644
--- a/audio_a2dp_hw/Makefile.am
+++ b/audio_a2dp_hw/Makefile.am
@@ -15,8 +15,6 @@ AM_CPPFLAGS= \
         -I../types \
         -I../utils/include \
         -I../audio_a2dp_hw/include \
-        -I${WORKSPACE}/system/media/audio/include \
-        -I${WORKSPACE}/hardware/libhardware/include \
         -I$(bdroid_C_INCLUDES)
 
 cpp_sources = \
diff --git a/bta/Makefile.am b/bta/Makefile.am
index cbae4a836..c393cf145 100644
--- a/bta/Makefile.am
+++ b/bta/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -33,12 +33,12 @@ AM_CPPFLAGS = -Iinclude \
         -I../internal_include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/vhal/include \
-        -I$(WORKSPACE)/bluetooth/bt_audio/hal/include \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/bta/ar \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/bta/avk \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/bta/include \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/stack/include \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/bta/tws_plus
+        -I$(BT_SOURCE)/bt_audio/hal/include \
+        -I$(BT_SOURCE)/stack/bluetooth_ext/system_bt_ext/bta/ar \
+        -I$(BT_SOURCE)/stack/bluetooth_ext/system_bt_ext/bta/avk \
+        -I$(BT_SOURCE)/stack/bluetooth_ext/system_bt_ext/bta/include \
+        -I$(BT_SOURCE)/stack/bluetooth_ext/system_bt_ext/stack/include \
+        -I$(BT_SOURCE)/stack/bluetooth_ext/system_bt_ext/bta/tws_plus
 
 if MDM_CHEROKEE
 AM_CPPFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
diff --git a/btcore/Makefile.am b/btcore/Makefile.am
index 1e21f9e21..548f9529e 100644
--- a/btcore/Makefile.am
+++ b/btcore/Makefile.am
@@ -11,8 +11,7 @@ AM_CPPFLAGS = \
         -I../ \
         -Iinclude \
         -I../types \
-        -I../include \
-        -I$(WORKSPACE)/vendor/qcom/opensource/bluetooth/hal/include
+        -I../include
 
 cpp_sources = \
         src/device_class.cc \
diff --git a/btif/Makefile.am b/btif/Makefile.am
index fa0b0f55d..523d668df 100644
--- a/btif/Makefile.am
+++ b/btif/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -42,18 +42,11 @@ AM_CPPFLAGS = \
         -I../audio_a2dp_hw \
         -I../utils/include \
         -I../internal_include \
-        -I${WORKSPACE}/external/tinyxml2 \
-        -I${WORKSPACE}/external/zlib \
         -I${external_bt_path}/vhal/include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/system_bt_ext/btif/include \
 	-I$(external_bt_path)/system_bt_ext/bta/include \
-	-I$(external_bt_path)/system_bt_ext/stack/include \
-        -I$(WORKSPACE)/vendor/qcom/opensource/bluetooth/hal/include \
-        -I$(WORKSPACE)/frameworks/av/include \
-        -I$(WORKSPACE)/system/media/audio/include \
-        -I$(WORKSPACE)/system/media/audio_utils/include \
-        -I$(WORKSPACE)/system/core/include
+	-I$(external_bt_path)/system_bt_ext/stack/include
 
 if MDM_CHEROKEE
 AM_CPPFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
diff --git a/device/Makefile.am b/device/Makefile.am
index 95a01bc01..b5acd3896 100644
--- a/device/Makefile.am
+++ b/device/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -20,8 +20,7 @@ AM_CPPFLAGS = \
         -I../stack/include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/vhal/include \
-        -I$(external_bt_path)/system_bt_ext/device/include \
-        -I$(WORKSPACE)/vendor/qcom/opensource/bluetooth/hal/include
+        -I$(external_bt_path)/system_bt_ext/device/include
 
 cpp_sources = \
         src/controller.cc \
diff --git a/hci/Makefile.am b/hci/Makefile.am
index 4842972e7..c1fba5b09 100644
--- a/hci/Makefile.am
+++ b/hci/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -10,13 +10,13 @@ AM_CFLAGS = -Wall \
         -DHAS_NO_BDROID_BUILDCFG
 
 AM_CPPFLAGS = -Iinclude -I../include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/btcore/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/stack/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/utils/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/bta/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/types \
-		-I$(WORKSPACE)/bluetooth/stack/system/bt/ \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/internal_include \
+        -I$(BT_SOURCE)/stack/system/bt/btcore/include \
+        -I$(BT_SOURCE)/stack/system/bt/stack/include \
+        -I$(BT_SOURCE)/stack/system/bt/utils/include \
+        -I$(BT_SOURCE)/stack/system/bt/bta/include \
+        -I$(BT_SOURCE)/stack/system/bt/types \
+	-I$(BT_SOURCE)/stack/system/bt/ \
+        -I$(BT_SOURCE)/stack/system/bt/internal_include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/system_bt_ext/include \
         -I$(external_bt_path)/vhal/include \
diff --git a/main/Makefile.am b/main/Makefile.am
index f4396949a..628f22311 100644
--- a/main/Makefile.am
+++ b/main/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -41,12 +41,10 @@ AM_CPPFLAGS= \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/system_bt_ext/include/ \
         -I$(external_bt_path)/system_bt_ext/device/include/ \
-        -I${WORKSPACE}/external/tinyxml2 \
-        -I${WORKSPACE}/external/zlib \
-        -I${WORKSPACE}/bluetooth/bt_audio/hal/include \
-        -I${WORKSPACE}/bluetooth/stack/bluetooth_ext/system_bt_ext/stack/include \
-        -I${WORKSPACE}/bluetooth/bt_audio/bthost_ipc \
-        -I${WORKSPACE}/bluetooth/stack/bluetooth_ext/system_bt_ext/udrv/include \
+        -I${BT_SOURCE}/bt_audio/hal/include \
+        -I${BT_SOURCE}/stack/bluetooth_ext/system_bt_ext/stack/include \
+        -I${BT_SOURCE}/bt_audio/bthost_ipc \
+        -I${BT_SOURCE}/stack/bluetooth_ext/system_bt_ext/udrv/include \
         -I$(external_bt_path)/vhal/include
 
 if MDM_ROME
diff --git a/osi/Makefile.am b/osi/Makefile.am
index 8e12c514c..2864d31c0 100644
--- a/osi/Makefile.am
+++ b/osi/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -16,7 +16,7 @@ AM_CPPFLAGS = \
         -I../stack/include \
         -I../include \
         -I../types \
-        -I$(WORKSPACE)/bluetooth/bt_audio/hal/include \
+        -I$(BT_SOURCE)/bt_audio/hal/include \
         -I$(external_bt_path)/vhal/include
 
 cpp_sources = \
diff --git a/stack/Makefile.am b/stack/Makefile.am
index a78e770ac..0f758c6fa 100644
--- a/stack/Makefile.am
+++ b/stack/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -12,9 +12,6 @@ if MDM_CHEROKEE
 AM_CFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
 endif
 
-$(info $$external_bt_path is [${external_bt_path}])
-$(info $$WORKSPACE is [${WORKSPACE}])
-
 AM_CPPFLAGS = \
         -Ia2dp \
         -Iinclude \
@@ -31,30 +28,30 @@ AM_CPPFLAGS = \
         -Isdp \
         -Ismp \
         -Isrvc \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/ \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/btcore/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/vnd/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/vnd/ble \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/btif/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/hci/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/udrv/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/rpc/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/hcis \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/ctrlr/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/bta/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/bta/sys \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/utils/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/types \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/internal_include \
+        -I$(BT_SOURCE)/stack/system/bt/ \
+        -I$(BT_SOURCE)/stack/system/bt/include \
+        -I$(BT_SOURCE)/stack/system/bt/btcore/include \
+        -I$(BT_SOURCE)/stack/system/bt/vnd/include \
+        -I$(BT_SOURCE)/stack/system/bt/vnd/ble \
+        -I$(BT_SOURCE)/stack/system/bt/btif/include \
+        -I$(BT_SOURCE)/stack/system/bt/hci/include \
+        -I$(BT_SOURCE)/stack/system/bt/include \
+        -I$(BT_SOURCE)/stack/system/bt/udrv/include \
+        -I$(BT_SOURCE)/stack/system/bt/rpc/include \
+        -I$(BT_SOURCE)/stack/system/bt/hcis \
+        -I$(BT_SOURCE)/stack/system/bt/ctrlr/include \
+        -I$(BT_SOURCE)/stack/system/bt/bta/include \
+        -I$(BT_SOURCE)/stack/system/bt/bta/sys \
+        -I$(BT_SOURCE)/stack/system/bt/utils/include \
+        -I$(BT_SOURCE)/stack/system/bt/types \
+        -I$(BT_SOURCE)/stack/system/bt/internal_include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/system_bt_ext/stack/btm \
         -I$(external_bt_path)/vhal/include \
         -I$(external_bt_path)/system_bt_ext/bta/ar \
 	-I$(external_bt_path)/system_bt_ext/bta/include \
         -I$(external_bt_path)/system_bt_ext/stack/include/ \
-        -I$(WORKSPACE)/bluetooth/bt_audio/hal/include
+        -I$(BT_SOURCE)/bt_audio/hal/include
 		
 if MDM_CHEROKEE
 AM_CPPFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
diff --git a/utils/Makefile.am b/utils/Makefile.am
index 7dbb795fb..a861f160a 100644
--- a/utils/Makefile.am
+++ b/utils/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wno-gnu-variable-sized-type-not-at-end \
         -Wundef \
@@ -24,7 +24,7 @@ AM_CPPFLAGS= \
         -I../include \
         -I../types \
         -I../ \
-        -I$(WORKSPACE)/bluetooth/bt_audio/hal/include \
+        -I$(BT_SOURCE)/bt_audio/hal/include \
         -I$(bdroid_C_INCLUDES)
 
 if MDM_ROME
-- 
2.25.1

