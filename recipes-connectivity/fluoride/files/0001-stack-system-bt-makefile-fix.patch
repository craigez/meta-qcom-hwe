From d668ac12a30af50911a80380dd7053a8a1790ec6 Mon Sep 17 00:00:00 2001
From: Viswanath Kraleti <quic_vkraleti@quicinc.com>
Date: Sat, 23 Dec 2023 08:13:19 +0530
Subject: [PATCH] stack-system-bt: makefile fix

---
 audio_a2dp_hw/Makefile.am      | 14 +++----
 bta/Makefile.am                | 48 +++++++++++------------
 btcore/Makefile.am             |  9 ++---
 btif/Makefile.am               | 65 ++++++++++++++----------------
 device/Makefile.am             | 21 +++++-----
 embdrv/sbc/decoder/Makefile.am |  4 +-
 hci/Makefile.am                | 18 ++++-----
 main/Makefile.am               | 60 ++++++++++++++--------------
 osi/Makefile.am                | 14 +++----
 stack/Makefile.am              | 72 +++++++++++++++++-----------------
 tools/bdtool/Makefile.am       |  8 ++--
 utils/Makefile.am              | 23 +++++------
 12 files changed, 171 insertions(+), 185 deletions(-)

diff --git a/audio_a2dp_hw/Makefile.am b/audio_a2dp_hw/Makefile.am
index 1cf48a0f3..d1bdc451a 100644
--- a/audio_a2dp_hw/Makefile.am
+++ b/audio_a2dp_hw/Makefile.am
@@ -9,14 +9,12 @@ AM_CFLAGS = -Wall \
         -DHAS_NO_BDROID_BUILDCFG
 
 AM_CPPFLAGS= \
-        -I. \
-        -I../ \
-        -I../include \
-        -I../types \
-        -I../utils/include \
-        -I../audio_a2dp_hw/include \
-        -I${WORKSPACE}/system/media/audio/include \
-        -I${WORKSPACE}/hardware/libhardware/include \
+        -I$(srcdir) \
+        -I$(srcdir)/.. \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/../utils/include \
+        -I$(srcdir)/../audio_a2dp_hw/include \
         -I$(bdroid_C_INCLUDES)
 
 cpp_sources = \
diff --git a/bta/Makefile.am b/bta/Makefile.am
index cbae4a836..44ec9b413 100644
--- a/bta/Makefile.am
+++ b/bta/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -14,31 +14,31 @@ AM_CFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
 AM_CFLAGS += -DBTA_AV_SPLIT_A2DP_DEF_FREQ_48KHZ
 endif
 
-AM_CPPFLAGS = -Iinclude \
-        -Isys \
-        -Idm \
-        -Ihh \
-        -Iag \
-        -I../ \
-        -I../btcore/include \
-        -I../hci/include \
-        -I../include \
-        -I../stack/include \
-        -I../stack/avdt \
-        -I../stack/btm \
-        -I../udrv/include \
-        -I../vnd/include \
-        -I../utils/include \
-        -I../types \
-        -I../internal_include \
+AM_CPPFLAGS = -I$(srcdir)/include \
+        -I$(srcdir)/sys \
+        -I$(srcdir)/dm \
+        -I$(srcdir)/hh \
+        -I$(srcdir)/ag \
+        -I$(srcdir)/../ \
+        -I$(srcdir)/../btcore/include \
+        -I$(srcdir)/../hci/include \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../stack/include \
+        -I$(srcdir)/../stack/avdt \
+        -I$(srcdir)/../stack/btm \
+        -I$(srcdir)/../udrv/include \
+        -I$(srcdir)/../vnd/include \
+        -I$(srcdir)/../utils/include \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/../internal_include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/vhal/include \
-        -I$(WORKSPACE)/bluetooth/bt_audio/hal/include \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/bta/ar \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/bta/avk \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/bta/include \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/stack/include \
-        -I$(WORKSPACE)/bluetooth/stack/bluetooth_ext/system_bt_ext/bta/tws_plus
+        -I$(external_bt_path)/system_bt_ext/bta/ar \
+        -I$(external_bt_path)/system_bt_ext/bta/avk \
+        -I$(external_bt_path)/system_bt_ext/bta/include \
+        -I$(external_bt_path)/system_bt_ext/stack/include \
+        -I$(external_bt_path)/system_bt_ext/bta/tws_plus \
+        -I$(BT_SOURCE)/bt_audio/hal/include
 
 if MDM_CHEROKEE
 AM_CPPFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
diff --git a/btcore/Makefile.am b/btcore/Makefile.am
index 1e21f9e21..cc58971e9 100644
--- a/btcore/Makefile.am
+++ b/btcore/Makefile.am
@@ -8,11 +8,10 @@ AM_CFLAGS = -Wall \
         -DHAS_NO_BDROID_BUILDCFG
 
 AM_CPPFLAGS = \
-        -I../ \
-        -Iinclude \
-        -I../types \
-        -I../include \
-        -I$(WORKSPACE)/vendor/qcom/opensource/bluetooth/hal/include
+        -I$(srcdir)/.. \
+        -I$(srcdir)/include \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/../include
 
 cpp_sources = \
         src/device_class.cc \
diff --git a/btif/Makefile.am b/btif/Makefile.am
index fa0b0f55d..e1e3a4ba0 100644
--- a/btif/Makefile.am
+++ b/btif/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -15,45 +15,38 @@ AM_CFLAGS += -DAPTX_48000
 endif
 
 AM_CPPFLAGS = \
-        -I../ \
-        -I../bta/include \
-        -I../bta/sys \
-        -I../bta/dm \
-        -I../btcore/include \
-        -I../include \
-        -I../stack/include \
-        -I../stack/l2cap \
-        -I../stack/a2dp \
-        -I../stack/btm \
-        -I../stack/avdt \
-        -I../hcis \
-        -I../types \
-        -I../include \
-        -I../hcis/include \
-        -I../hcis/patchram \
-        -I../udrv/include \
-        -I../btif/include \
-        -I../btif/co \
-        -I../hci/include\
-        -I../vnd/include \
-        -I../brcm/include \
-        -I../embdrv/sbc/encoder/include \
-        -I../embdrv/sbc/decoder/include \
-        -I../audio_a2dp_hw \
-        -I../utils/include \
-        -I../internal_include \
-        -I${WORKSPACE}/external/tinyxml2 \
-        -I${WORKSPACE}/external/zlib \
+        -I$(srcdir)/.. \
+        -I$(srcdir)/../bta/include \
+        -I$(srcdir)/../bta/sys \
+        -I$(srcdir)/../bta/dm \
+        -I$(srcdir)/../btcore/include \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../stack/include \
+        -I$(srcdir)/../stack/l2cap \
+        -I$(srcdir)/../stack/a2dp \
+        -I$(srcdir)/../stack/btm \
+        -I$(srcdir)/../stack/avdt \
+        -I$(srcdir)/../hcis \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../hcis/include \
+        -I$(srcdir)/../hcis/patchram \
+        -I$(srcdir)/../udrv/include \
+        -I$(srcdir)/../btif/include \
+        -I$(srcdir)/../btif/co \
+        -I$(srcdir)/../hci/include\
+        -I$(srcdir)/../vnd/include \
+        -I$(srcdir)/../brcm/include \
+        -I$(srcdir)/../embdrv/sbc/encoder/include \
+        -I$(srcdir)/../embdrv/sbc/decoder/include \
+        -I$(srcdir)/../audio_a2dp_hw \
+        -I$(srcdir)/../utils/include \
+        -I$(srcdir)/../internal_include \
         -I${external_bt_path}/vhal/include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/system_bt_ext/btif/include \
 	-I$(external_bt_path)/system_bt_ext/bta/include \
-	-I$(external_bt_path)/system_bt_ext/stack/include \
-        -I$(WORKSPACE)/vendor/qcom/opensource/bluetooth/hal/include \
-        -I$(WORKSPACE)/frameworks/av/include \
-        -I$(WORKSPACE)/system/media/audio/include \
-        -I$(WORKSPACE)/system/media/audio_utils/include \
-        -I$(WORKSPACE)/system/core/include
+	-I$(external_bt_path)/system_bt_ext/stack/include
 
 if MDM_CHEROKEE
 AM_CPPFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
diff --git a/device/Makefile.am b/device/Makefile.am
index 95a01bc01..e87818a2c 100644
--- a/device/Makefile.am
+++ b/device/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -10,18 +10,17 @@ AM_CFLAGS = -Wall \
         -DHAS_NO_BDROID_BUILDCFG
 
 AM_CPPFLAGS = \
-        -I../ \
-        -Iinclude \
-        -I../btcore/include \
-        -I../hci/include \
-        -I../include \
-        -I../types \
-        -I../internal_include \
-        -I../stack/include \
+        -I$(srcdir)/.. \
+        -I$(srcdir)/include \
+        -I$(srcdir)/../btcore/include \
+        -I$(srcdir)/../hci/include \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/../internal_include \
+        -I$(srcdir)/../stack/include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/vhal/include \
-        -I$(external_bt_path)/system_bt_ext/device/include \
-        -I$(WORKSPACE)/vendor/qcom/opensource/bluetooth/hal/include
+        -I$(external_bt_path)/system_bt_ext/device/include
 
 cpp_sources = \
         src/controller.cc \
diff --git a/embdrv/sbc/decoder/Makefile.am b/embdrv/sbc/decoder/Makefile.am
index 46662e86f..302dea6f4 100644
--- a/embdrv/sbc/decoder/Makefile.am
+++ b/embdrv/sbc/decoder/Makefile.am
@@ -7,8 +7,8 @@ AM_CFLAGS = -Wall \
         -std=c99 \
         -DHAS_NO_BDROID_BUILDCFG
 
-AM_CPPFLAGS = -Iinclude \
-              -Isrce
+AM_CPPFLAGS = -I$(srcdir)/include \
+              -I$(srcdir)/srce
 
 c_sources = \
         ./srce/alloc.c \
diff --git a/hci/Makefile.am b/hci/Makefile.am
index 4842972e7..8a5d59f30 100644
--- a/hci/Makefile.am
+++ b/hci/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -9,14 +9,14 @@ AM_CFLAGS = -Wall \
         -std=c++11 \
         -DHAS_NO_BDROID_BUILDCFG
 
-AM_CPPFLAGS = -Iinclude -I../include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/btcore/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/stack/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/utils/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/bta/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/types \
-		-I$(WORKSPACE)/bluetooth/stack/system/bt/ \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/internal_include \
+AM_CPPFLAGS = -I$(srcdir)/include -I$(srcdir)/../include \
+        -I$(srcdir)/../btcore/include \
+        -I$(srcdir)/../stack/include \
+        -I$(srcdir)/../utils/include \
+        -I$(srcdir)/../bta/include \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/.. \
+        -I$(srcdir)/../internal_include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/system_bt_ext/include \
         -I$(external_bt_path)/vhal/include \
diff --git a/main/Makefile.am b/main/Makefile.am
index f4396949a..92cd21829 100644
--- a/main/Makefile.am
+++ b/main/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -10,30 +10,30 @@ AM_CFLAGS = -Wall \
         -DHAS_NO_BDROID_BUILDCFG
 
 AM_CPPFLAGS= \
-        -I../ \
-        -I../audio_a2dp_hw/include \
-        -I../bta/include \
-        -I../bta/sys \
-        -I../bta/dm \
-        -I../btcore/include \
-        -I../include \
-        -I../stack/include \
-        -I../stack/l2cap \
-        -I../stack/a2dp \
-        -I../stack/btm \
-        -I../stack/avdt \
-        -I../udrv/include \
-        -I../btif/include \
-        -I../btif/co \
-        -I../hci/include\
-        -I../vnd/include \
-        -I../brcm/include \
-        -I../embdrv/sbc/encoder/include \
-        -I../embdrv/sbc/decoder/include \
-        -I../audio_a2dp_hw \
-        -I../utils/include \
-        -I../types \
-        -I../internal_include \
+        -I$(srcdir)/.. \
+        -I$(srcdir)/../audio_a2dp_hw/include \
+        -I$(srcdir)/../bta/include \
+        -I$(srcdir)/../bta/sys \
+        -I$(srcdir)/../bta/dm \
+        -I$(srcdir)/../btcore/include \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../stack/include \
+        -I$(srcdir)/../stack/l2cap \
+        -I$(srcdir)/../stack/a2dp \
+        -I$(srcdir)/../stack/btm \
+        -I$(srcdir)/../stack/avdt \
+        -I$(srcdir)/../udrv/include \
+        -I$(srcdir)/../btif/include \
+        -I$(srcdir)/../btif/co \
+        -I$(srcdir)/../hci/include\
+        -I$(srcdir)/../vnd/include \
+        -I$(srcdir)/../brcm/include \
+        -I$(srcdir)/../embdrv/sbc/encoder/include \
+        -I$(srcdir)/../embdrv/sbc/decoder/include \
+        -I$(srcdir)/../audio_a2dp_hw \
+        -I$(srcdir)/../utils/include \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/../internal_include \
         -I$(external_bt_path)/system_bt_ext/bta/include \
         -I$(external_bt_path)/system_bt_ext/bta/ar \
         -I$(external_bt_path)/system_bt_ext/btif/include \
@@ -41,12 +41,10 @@ AM_CPPFLAGS= \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/system_bt_ext/include/ \
         -I$(external_bt_path)/system_bt_ext/device/include/ \
-        -I${WORKSPACE}/external/tinyxml2 \
-        -I${WORKSPACE}/external/zlib \
-        -I${WORKSPACE}/bluetooth/bt_audio/hal/include \
-        -I${WORKSPACE}/bluetooth/stack/bluetooth_ext/system_bt_ext/stack/include \
-        -I${WORKSPACE}/bluetooth/bt_audio/bthost_ipc \
-        -I${WORKSPACE}/bluetooth/stack/bluetooth_ext/system_bt_ext/udrv/include \
+        -I${BT_SOURCE}/bt_audio/hal/include \
+        -I${BT_SOURCE}/stack/bluetooth_ext/system_bt_ext/stack/include \
+        -I${BT_SOURCE}/bt_audio/bthost_ipc \
+        -I${BT_SOURCE}/stack/bluetooth_ext/system_bt_ext/udrv/include \
         -I$(external_bt_path)/vhal/include
 
 if MDM_ROME
diff --git a/osi/Makefile.am b/osi/Makefile.am
index 8e12c514c..a6d7f85a3 100644
--- a/osi/Makefile.am
+++ b/osi/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -11,12 +11,12 @@ AM_CFLAGS = -Wall \
         -D__GLIBC__
 
 AM_CPPFLAGS = \
-        -I../ \
-        -I../utils/include \
-        -I../stack/include \
-        -I../include \
-        -I../types \
-        -I$(WORKSPACE)/bluetooth/bt_audio/hal/include \
+        -I$(srcdir)/.. \
+        -I$(srcdir)/../utils/include \
+        -I$(srcdir)/../stack/include \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../types \
+        -I$(BT_SOURCE)/bt_audio/hal/include \
         -I$(external_bt_path)/vhal/include
 
 cpp_sources = \
diff --git a/stack/Makefile.am b/stack/Makefile.am
index a78e770ac..cb7413da9 100644
--- a/stack/Makefile.am
+++ b/stack/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wall \
         -Wundef \
@@ -12,49 +12,47 @@ if MDM_CHEROKEE
 AM_CFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
 endif
 
-$(info $$external_bt_path is [${external_bt_path}])
-$(info $$WORKSPACE is [${WORKSPACE}])
-
 AM_CPPFLAGS = \
-        -Ia2dp \
-        -Iinclude \
-        -Iavct \
-        -Ibtm \
-        -Iavrc \
-        -Il2cap \
-        -Iavdt \
-        -Igatt \
-        -Igap \
-        -Ipan \
-        -Ibnep \
-        -Ihid \
-        -Isdp \
-        -Ismp \
-        -Isrvc \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/ \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/btcore/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/vnd/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/vnd/ble \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/btif/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/hci/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/udrv/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/rpc/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/hcis \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/ctrlr/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/bta/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/bta/sys \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/utils/include \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/types \
-        -I$(WORKSPACE)/bluetooth/stack/system/bt/internal_include \
+        -I$(srcdir)/a2dp \
+        -I$(srcdir)/include \
+        -I$(srcdir)/avct \
+        -I$(srcdir)/btm \
+        -I$(srcdir)/avrc \
+        -I$(srcdir)/l2cap \
+        -I$(srcdir)/avdt \
+        -I$(srcdir)/gatt \
+        -I$(srcdir)/gap \
+        -I$(srcdir)/pan \
+        -I$(srcdir)/bnep \
+        -I$(srcdir)/hid \
+        -I$(srcdir)/sdp \
+        -I$(srcdir)/smp \
+        -I$(srcdir)/srvc \
+        -I$(srcdir)/ \
+        -I$(srcdir)/.. \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../btcore/include \
+        -I$(srcdir)/../vnd/include \
+        -I$(srcdir)/../vnd/ble \
+        -I$(srcdir)/../btif/include \
+        -I$(srcdir)/../hci/include \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../udrv/include \
+        -I$(srcdir)/../rpc/include \
+        -I$(srcdir)/../hcis \
+        -I$(srcdir)/../ctrlr/include \
+        -I$(srcdir)/../bta/include \
+        -I$(srcdir)/../bta/sys \
+        -I$(srcdir)/../utils/include \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/../internal_include \
         -I$(external_bt_path)/system_bt_ext \
         -I$(external_bt_path)/system_bt_ext/stack/btm \
         -I$(external_bt_path)/vhal/include \
         -I$(external_bt_path)/system_bt_ext/bta/ar \
 	-I$(external_bt_path)/system_bt_ext/bta/include \
         -I$(external_bt_path)/system_bt_ext/stack/include/ \
-        -I$(WORKSPACE)/bluetooth/bt_audio/hal/include
+        -I$(BT_SOURCE)/bt_audio/hal/include
 		
 if MDM_CHEROKEE
 AM_CPPFLAGS += -DBTA_AV_SPLIT_A2DP_ENABLED
diff --git a/tools/bdtool/Makefile.am b/tools/bdtool/Makefile.am
index 3c3273654..19e13ece2 100644
--- a/tools/bdtool/Makefile.am
+++ b/tools/bdtool/Makefile.am
@@ -7,10 +7,10 @@ AM_CFLAGS = -Wall \
         -std=c99
 
 AM_CPPFLAGS= \
-        -I../inc/ \
-        -I../../include \
-        -I../../stack/include \
-        -I../../test/suite
+        -I$(srcdir)/../inc/ \
+        -I$(srcdir)/../../include \
+        -I$(srcdir)/../../stack/include \
+        -I$(srcdir)/../../test/suite
 
 # HAL layer
 c_sources = \
diff --git a/utils/Makefile.am b/utils/Makefile.am
index 7dbb795fb..b45f40310 100644
--- a/utils/Makefile.am
+++ b/utils/Makefile.am
@@ -1,6 +1,6 @@
 # sources and intermediate files are separated
 
-external_bt_path := $(WORKSPACE)/bluetooth/stack/bluetooth_ext
+external_bt_path := $(BT_SOURCE)/stack/bluetooth_ext
 
 AM_CFLAGS = -Wno-gnu-variable-sized-type-not-at-end \
         -Wundef \
@@ -14,17 +14,18 @@ AM_CFLAGS = -Wno-gnu-variable-sized-type-not-at-end \
         -DHAS_NO_BDROID_BUILDCFG
 
 AM_CPPFLAGS= \
-        -Iinclude \
-        -I../btcore/include \
-        -I../stack/include \
-        -I../utils/include \
-        -I../bta/include \
-        -I../internal_include \
+        -I$(srcdir)/include \
+        -I$(srcdir)/../btcore/include \
+        -I$(srcdir)/../stack/include \
+        -I$(srcdir)/../utils/include \
+        -I$(srcdir)/../bta/include \
+        -I$(srcdir)/../internal_include \
         -I$(external_bt_path)/vhal/include \
-        -I../include \
-        -I../types \
-        -I../ \
-        -I$(WORKSPACE)/bluetooth/bt_audio/hal/include \
+        -I$(BT_SOURCE)/bt_audio/hal/include \
+        -I$(srcdir)/../include \
+        -I$(srcdir)/../types \
+        -I$(srcdir)/../ \
+        -I$(BT_SOURCE)/bt_audio/hal/include \
         -I$(bdroid_C_INCLUDES)
 
 if MDM_ROME
-- 
2.25.1

